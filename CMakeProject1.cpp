#include "CMakeProject1.h"

int fun()
{
    // instantiate the IGES data object
    DLL_IGES model;

    // create a custom color (magenta)  1P
    DLL_IGES_ENTITY_314 color(model, true);
    color.SetColor(100.0, 100.0, 100.0);

    //nurbs surface 1  3P
    DLL_IGES_ENTITY_128 nurbs(model, true);
    double knots_u[] = { 0, 0, 0, 0, 0.058338, 0.0997282, 0.14926, 0.198628,
                        0.247855, 0.29697, 0.337858, 0.370577, 0.395193, 0.419957,
                        0.440753, 0.457613, 0.470638, 0.481894, 0.492909, 0.5, 0.5, 0.5, 0.5 };
    double knots_v[] = { 0, 0, 0, 0, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 1, 1, 1, 1 };
    double control_pts[] = { 1, 0, 0,
                            0.961532, 0.00987942, 0,
                            0.894822, 0.0219348, 0,
                            0.7947, 0.038711, 0,
                            0.700271, 0.0521391, 0,
                            0.600251, 0.0641136, 0,
                            0.500185, 0.0728556, 0,
                            0.405677, 0.0784517, 0,
                            0.322192, 0.0797944, 0,
                            0.255436, 0.0774704, 0,
                            0.199774, 0.0729726, 0,
                            0.152429, 0.0669008, 0,
                            0.110661, 0.0592505, 0,
                            0.0772534, 0.0505523, 0,
                            0.0506891, 0.0420328, 0,
                            0.0283945, 0.0321841, 0,
                            0.0117425, 0.0223884, 0,
                            0.00257961, 0.0112275, 0,
                            0.000895725, 0.00671206, 0,
                            1, 0, 0.133333,
                            0.961532, 0.00987942, 0.133333,
                            0.894822, 0.0219348, 0.133333,
                            0.7947, 0.038711, 0.133333,
                            0.700271, 0.0521391, 0.133333,
                            0.600251, 0.0641136, 0.133333,
                            0.500185, 0.0728556, 0.133333,
                            0.405677, 0.0784517, 0.133333,
                            0.322192, 0.0797944, 0.133333,
                            0.255436, 0.0774704, 0.133333,
                            0.199774, 0.0729726, 0.133333,
                            0.152429, 0.0669008, 0.133333,
                            0.110661, 0.0592505, 0.133333,
                            0.0772534, 0.0505523, 0.133333,
                            0.0506891, 0.0420328, 0.133333,
                            0.0283945, 0.0321841, 0.133333,
                            0.0117425, 0.0223884, 0.133333,
                            0.00257961, 0.0112275, 0.133333,
                            0.000895725, 0.00671206, 0.133333,
                            1, 0, 0.333333,
                            0.961532, 0.00987942, 0.333333,
                            0.894822, 0.0219348, 0.333333,
                            0.7947, 0.038711, 0.333333,
                            0.700271, 0.0521391, 0.333333,
                            0.600251, 0.0641136, 0.333333,
                            0.500185, 0.0728556, 0.333333,
                            0.405677, 0.0784517, 0.333333,
                            0.322192, 0.0797944, 0.333333,
                            0.255436, 0.0774704, 0.333333,
                            0.199774, 0.0729726, 0.333333,
                            0.152429, 0.0669008, 0.333333,
                            0.110661, 0.0592505, 0.333333,
                            0.0772534, 0.0505523, 0.333333,
                            0.0506891, 0.0420328, 0.333333,
                            0.0283945, 0.0321841, 0.333333,
                            0.0117425, 0.0223884, 0.333333,
                            0.00257961, 0.0112275, 0.333333,
                            0.000895725, 0.00671206, 0.333333,
                            1, 0, 0.6,
                            0.961532, 0.00987942, 0.6,
                            0.894822, 0.0219348, 0.6,
                            0.7947, 0.038711, 0.6,
                            0.700271, 0.0521391, 0.6,
                            0.600251, 0.0641136, 0.6,
                            0.500185, 0.0728556, 0.6,
                            0.405677, 0.0784517, 0.6,
                            0.322192, 0.0797944, 0.6,
                            0.255436, 0.0774704, 0.6,
                            0.199774, 0.0729726, 0.6,
                            0.152429, 0.0669008, 0.6,
                            0.110661, 0.0592505, 0.6,
                            0.0772534, 0.0505523, 0.6,
                            0.0506891, 0.0420328, 0.6,
                            0.0283945, 0.0321841, 0.6,
                            0.0117425, 0.0223884, 0.6,
                            0.00257961, 0.0112275, 0.6,
                            0.000895725, 0.00671206, 0.6,
                            1, 0, 0.8,
                            0.961532, 0.00987942, 0.8,
                            0.894822, 0.0219348, 0.8,
                            0.7947, 0.038711, 0.8,
                            0.700271, 0.0521391, 0.8,
                            0.600251, 0.0641136, 0.8,
                            0.500185, 0.0728556, 0.8,
                            0.405677, 0.0784517, 0.8,
                            0.322192, 0.0797944, 0.8,
                            0.255436, 0.0774704, 0.8,
                            0.199774, 0.0729726, 0.8,
                            0.152429, 0.0669008, 0.8,
                            0.110661, 0.0592505, 0.8,
                            0.0772534, 0.0505523, 0.8,
                            0.0506891, 0.0420328, 0.8,
                            0.0283945, 0.0321841, 0.8,
                            0.0117425, 0.0223884, 0.8,
                            0.00257961, 0.0112275, 0.8,
                            0.000895725, 0.00671206, 0.8,
                            1, 0, 1,
                            0.961532, 0.00987942, 1,
                            0.894822, 0.0219348, 1,
                            0.7947, 0.038711, 1,
                            0.700271, 0.0521391, 1,
                            0.600251, 0.0641136, 1,
                            0.500185, 0.0728556, 1,
                            0.405677, 0.0784517, 1,
                            0.322192, 0.0797944, 1,
                            0.255436, 0.0774704, 1,
                            0.199774, 0.0729726, 1,
                            0.152429, 0.0669008, 1,
                            0.110661, 0.0592505, 1,
                            0.0772534, 0.0505523, 1,
                            0.0506891, 0.0420328, 1,
                            0.0283945, 0.0321841, 1,
                            0.0117425, 0.0223884, 1,
                            0.00257961, 0.0112275, 1,
                            0.000895725, 0.00671206, 1,
                            1, 0, 1.2,
                            0.961532, 0.00987942, 1.2,
                            0.894822, 0.0219348, 1.2,
                            0.7947, 0.038711, 1.2,
                            0.700271, 0.0521391, 1.2,
                            0.600251, 0.0641136, 1.2,
                            0.500185, 0.0728556, 1.2,
                            0.405677, 0.0784517, 1.2,
                            0.322192, 0.0797944, 1.2,
                            0.255436, 0.0774704, 1.2,
                            0.199774, 0.0729726, 1.2,
                            0.152429, 0.0669008, 1.2,
                            0.110661, 0.0592505, 1.2,
                            0.0772534, 0.0505523, 1.2,
                            0.0506891, 0.0420328, 1.2,
                            0.0283945, 0.0321841, 1.2,
                            0.0117425, 0.0223884, 1.2,
                            0.00257961, 0.0112275, 1.2,
                            0.000895725, 0.00671206, 1.2,
                            1, 0, 1.4,
                            0.961532, 0.00987942, 1.4,
                            0.894822, 0.0219348, 1.4,
                            0.7947, 0.038711, 1.4,
                            0.700271, 0.0521391, 1.4,
                            0.600251, 0.0641136, 1.4,
                            0.500185, 0.0728556, 1.4,
                            0.405677, 0.0784517, 1.4,
                            0.322192, 0.0797944, 1.4,
                            0.255436, 0.0774704, 1.4,
                            0.199774, 0.0729726, 1.4,
                            0.152429, 0.0669008, 1.4,
                            0.110661, 0.0592505, 1.4,
                            0.0772534, 0.0505523, 1.4,
                            0.0506891, 0.0420328, 1.4,
                            0.0283945, 0.0321841, 1.4,
                            0.0117425, 0.0223884, 1.4,
                            0.00257961, 0.0112275, 1.4,
                            0.000895725, 0.00671206, 1.4,
                            1, 0, 1.66667,
                            0.961532, 0.00987942, 1.66667,
                            0.894822, 0.0219348, 1.66667,
                            0.7947, 0.038711, 1.66667,
                            0.700271, 0.0521391, 1.66667,
                            0.600251, 0.0641136, 1.66667,
                            0.500185, 0.0728556, 1.66667,
                            0.405677, 0.0784517, 1.66667,
                            0.322192, 0.0797944, 1.66667,
                            0.255436, 0.0774704, 1.66667,
                            0.199774, 0.0729726, 1.66667,
                            0.152429, 0.0669008, 1.66667,
                            0.110661, 0.0592505, 1.66667,
                            0.0772534, 0.0505523, 1.66667,
                            0.0506891, 0.0420328, 1.66667,
                            0.0283945, 0.0321841, 1.66667,
                            0.0117425, 0.0223884, 1.66667,
                            0.00257961, 0.0112275, 1.66667,
                            0.000895725, 0.00671206, 1.66667,
                            1, 0, 1.86667,
                            0.961532, 0.00987942, 1.86667,
                            0.894822, 0.0219348, 1.86667,
                            0.7947, 0.038711, 1.86667,
                            0.700271, 0.0521391, 1.86667,
                            0.600251, 0.0641136, 1.86667,
                            0.500185, 0.0728556, 1.86667,
                            0.405677, 0.0784517, 1.86667,
                            0.322192, 0.0797944, 1.86667,
                            0.255436, 0.0774704, 1.86667,
                            0.199774, 0.0729726, 1.86667,
                            0.152429, 0.0669008, 1.86667,
                            0.110661, 0.0592505, 1.86667,
                            0.0772534, 0.0505523, 1.86667,
                            0.0506891, 0.0420328, 1.86667,
                            0.0283945, 0.0321841, 1.86667,
                            0.0117425, 0.0223884, 1.86667,
                            0.00257961, 0.0112275, 1.86667,
                            0.000895725, 0.00671206, 1.86667,
                            1, 0, 2,
                            0.961532, 0.00987942, 2,
                            0.894822, 0.0219348, 2,
                            0.7947, 0.038711, 2,
                            0.700271, 0.0521391, 2,
                            0.600251, 0.0641136, 2,
                            0.500185, 0.0728556, 2,
                            0.405677, 0.0784517, 2,
                            0.322192, 0.0797944, 2,
                            0.255436, 0.0774704, 2,
                            0.199774, 0.0729726, 2,
                            0.152429, 0.0669008, 2,
                            0.110661, 0.0592505, 2,
                            0.0772534, 0.0505523, 2,
                            0.0506891, 0.0420328, 2,
                            0.0283945, 0.0321841, 2,
                            0.0117425, 0.0223884, 2,
                            0.00257961, 0.0112275, 2,
                            0.000895725, 0.00671206, 2 };

    nurbs.SetNURBSData(19, 11, 4, 4, knots_u, knots_v, control_pts, false, false, false, 0.0, 0.5, 0., 1.0);

    //nurbs line 1 5P
    DLL_IGES_ENTITY_126 nurbs_line1(model, true);
    double line_knots[] = { 0.,0.,1.,1. };
    double line_cpts1[] = { 0.,0, 0, 0.5, 0, 0. };
    nurbs_line1.SetNURBSData(2, 2, line_knots, line_cpts1, false, 0.0, 1.0);

    //line 1 7P
    DLL_IGES_ENTITY_110 line1(model, true);
    line1.SetLineStart(0, 0, 0.);
    line1.SetLineEnd(0, 0, 2.);

    //nurbs line 2  9P
    DLL_IGES_ENTITY_126 nurbs_line2(model, true);
    double line_cpts2[] = { 0.5, 0, 0. , 0.5, 1., 0. };
    nurbs_line2.SetNURBSData(2, 2, line_knots, line_cpts2, false, 0.0, 1.0);


    //nurbs curve 1 11P
    DLL_IGES_ENTITY_126 nurbs_curve1(model, true);
    double curve_knots1[] = { 0, 0, 0, 0, 0.058338, 0.0997282, 0.14926, 0.198628,
                            0.247855, 0.29697, 0.337858, 0.370577, 0.395193, 0.419957,
                            0.440753, 0.457613, 0.470638, 0.481894, 0.492909, 0.5, 0.5, 0.5, 0.5 };
    double curve_cpts1[] = { 1, 0, 0,
                            0.961532, 0.00987942, 0,
                            0.894822, 0.0219348, 0,
                            0.7947, 0.038711, 0,
                            0.700271, 0.0521391, 0,
                            0.600251, 0.0641136, 0,
                            0.500185, 0.0728556, 0,
                            0.405677, 0.0784517, 0,
                            0.322192, 0.0797944, 0,
                            0.255436, 0.0774704, 0,
                            0.199774, 0.0729726, 0,
                            0.152429, 0.0669008, 0,
                            0.110661, 0.0592505, 0,
                            0.0772534, 0.0505523, 0,
                            0.0506891, 0.0420328, 0,
                            0.0283945, 0.0321841, 0,
                            0.0117425, 0.0223884, 0,
                            0.00257961, 0.0112275, 0,
                            0.000895725, 0.00671206, 0 };
    nurbs_curve1.SetNURBSData(19, 4, curve_knots1, curve_cpts1, false, 0., 0.5);

    //nurbs line 3 13P
    DLL_IGES_ENTITY_126 nurbs_line3(model, true);
    double line_cpts3[] = { 0.5, 1., 0., 0., 1., 0. };
    nurbs_line3.SetNURBSData(2, 2, line_knots, line_cpts3, false, 0.0, 1.0);

    //line 2 15P
    DLL_IGES_ENTITY_110 line2(model, true);
    line2.SetLineStart(1., 0., 2.);
    line2.SetLineEnd(1., 0., 0.);

    //nurbs line 4 17P
    DLL_IGES_ENTITY_126 nurbs_line4(model, true);
    double line_cpts4[] = { 0.,1.,0.,0.,0.,0. };
    nurbs_line4.SetNURBSData(2, 2, line_knots, line_cpts3, false, 0.0, 1.0);

    //nurbs curve 2 19P
    DLL_IGES_ENTITY_126 nurbs_curve2(model, true);
    double curve_cpts2[] = { 1, 0, 2,
                            0.961532, 0.00987942, 2,
                            0.894822, 0.0219348, 2,
                            0.7947, 0.038711, 2,
                            0.700271, 0.0521391, 2,
                            0.600251, 0.0641136, 2,
                            0.500185, 0.0728556, 2,
                            0.405677, 0.0784517, 2,
                            0.322192, 0.0797944, 2,
                            0.255436, 0.0774704, 2,
                            0.199774, 0.0729726, 2,
                            0.152429, 0.0669008, 2,
                            0.110661, 0.0592505, 2,
                            0.0772534, 0.0505523, 2,
                            0.0506891, 0.0420328, 2,
                            0.0283945, 0.0321841, 2,
                            0.0117425, 0.0223884, 2,
                            0.00257961, 0.0112275, 2,
                            0.000895725, 0.00671206, 2, };
    nurbs_curve2.SetNURBSData(19, 4, curve_knots1, curve_cpts2, false, 0., 0.5);

    // Composite Curve 1(Type 102) 21P
    DLL_IGES_ENTITY_102 compound1(model, true);
    compound1.AddSegment(nurbs_line1);
    compound1.AddSegment(nurbs_line2);
    compound1.AddSegment(nurbs_line3);
    compound1.AddSegment(nurbs_line4);

    // Composite Curve 2(Type 102) 23P
    DLL_IGES_ENTITY_102 compound2(model, true);
    compound2.AddSegment(line1);
    compound2.AddSegment(nurbs_curve1);
    compound2.AddSegment(line2);
    compound2.AddSegment(nurbs_curve2);

    // use the compound curve to define a surface boundary in model space  25P
    DLL_IGES_ENTITY_142 bound(model, true);
    bound.SetCurveCreationFlag(CURVE_CREATE_PROJECTION);
    bound.SetSurface(nurbs);
    bound.SetParameterSpaceBound(compound1);
    bound.SetModelSpaceBound(compound2);
    bound.SetCurvePreference(BOUND_PREF_PARAMSPACE);

    // create the Trimmed Parametric Surface (TPS) 27P
    DLL_IGES_ENTITY_144 surf(model, true);
    surf.SetSurface(nurbs);
    surf.SetBoundCurve(bound);
    surf.SetColor(color);


    model.Write("E:/Data/surface/1/new.IGS", true);
    std::cout << "OK!" << std::endl;

    return 0;
}